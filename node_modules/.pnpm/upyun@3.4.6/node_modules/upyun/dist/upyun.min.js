/**
  * UPYUN js-sdk 3.4.6
  * (c) 2022
  * @license MIT
  */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("axios")):"function"==typeof define&&define.amd?define(["axios"],t):e.upyun=t(e.axios)}(this,function(p){"use strict";p="default"in p?p.default:p;var a="undefined"!=typeof window&&("undefined"==typeof process||"browser"===process.title),u=1048576,v=function(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof e.then};var U="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(e,t){return e(t={exports:{}},t.exports),t.exports}var E=e(function(I,B){!function(e){var t=B&&!B.nodeType&&B,r=I&&!I.nodeType&&I,n="object"==typeof U&&U;n.global!==n&&n.window!==n&&n.self!==n||(e=n);var o,i,m=2147483647,g=36,b=1,x=26,s=38,a=700,w=72,A=128,j="-",u=/^xn--/,h=/[^\x20-\x7E]/,l=/[\x2E\u3002\uFF0E\uFF61]/g,c={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=g-b,C=Math.floor,k=String.fromCharCode;function S(e){throw RangeError(c[e])}function p(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function v(e,t){var r=e.split("@"),n="";return 1<r.length&&(n=r[0]+"@",e=r[1]),n+p((e=e.replace(l,".")).split("."),t).join(".")}function O(e){for(var t,r,n=[],o=0,i=e.length;o<i;)55296<=(t=e.charCodeAt(o++))&&t<=56319&&o<i?56320==(64512&(r=e.charCodeAt(o++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),o--):n.push(t);return n}function P(e){return p(e,function(e){var t="";return 65535<e&&(t+=k((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=k(e)}).join("")}function q(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function T(e,t,r){var n=0;for(e=r?C(e/a):e>>1,e+=C(e/t);f*x>>1<e;n+=g)e=C(e/f);return C(n+(f+1)*e/(e+s))}function d(e){var t,r,n,o,i,s,a,u,h,l,c,f=[],p=e.length,v=0,d=A,y=w;for((r=e.lastIndexOf(j))<0&&(r=0),n=0;n<r;++n)128<=e.charCodeAt(n)&&S("not-basic"),f.push(e.charCodeAt(n));for(o=0<r?r+1:0;o<p;){for(i=v,s=1,a=g;p<=o&&S("invalid-input"),c=e.charCodeAt(o++),(g<=(u=c-48<10?c-22:c-65<26?c-65:c-97<26?c-97:g)||u>C((m-v)/s))&&S("overflow"),v+=u*s,!(u<(h=a<=y?b:y+x<=a?x:a-y));a+=g)s>C(m/(l=g-h))&&S("overflow"),s*=l;y=T(v-i,t=f.length+1,0==i),C(v/t)>m-d&&S("overflow"),d+=C(v/t),v%=t,f.splice(v++,0,d)}return P(f)}function y(e){var t,r,n,o,i,s,a,u,h,l,c,f,p,v,d,y=[];for(f=(e=O(e)).length,t=A,i=w,s=r=0;s<f;++s)(c=e[s])<128&&y.push(k(c));for(n=o=y.length,o&&y.push(j);n<f;){for(a=m,s=0;s<f;++s)t<=(c=e[s])&&c<a&&(a=c);for(a-t>C((m-r)/(p=n+1))&&S("overflow"),r+=(a-t)*p,t=a,s=0;s<f;++s)if((c=e[s])<t&&++r>m&&S("overflow"),c==t){for(u=r,h=g;!(u<(l=h<=i?b:i+x<=h?x:h-i));h+=g)d=u-l,v=g-l,y.push(k(q(l+d%v,0))),u=C(d/v);y.push(k(q(u,0))),i=T(r,p,n==o),r=0,++n}++r,++t}return y.join("")}if(o={version:"1.3.2",ucs2:{decode:O,encode:P},decode:d,encode:y,toASCII:function(e){return v(e,function(e){return h.test(e)?"xn--"+y(e):e})},toUnicode:function(e){return v(e,function(e){return u.test(e)?d(e.slice(4).toLowerCase()):e})}},t&&r)if(I.exports==t)r.exports=o;else for(i in o)o.hasOwnProperty(i)&&(t[i]=o[i]);else e.punycode=o}(U)}),N={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}};function r(e,t,r,n){t=t||"&",r=r||"=";var o={};if("string"!=typeof e||0===e.length)return o;var i=/\+/g;e=e.split(t);var s=1e3;n&&"number"==typeof n.maxKeys&&(s=n.maxKeys);var a,u,h=e.length;0<s&&s<h&&(h=s);for(var l=0;l<h;++l){var c,f,p,v,d=e[l].replace(i,"%20"),y=d.indexOf(r);f=0<=y?(c=d.substr(0,y),d.substr(y+1)):(c=d,""),p=decodeURIComponent(c),v=decodeURIComponent(f),a=o,u=p,Object.prototype.hasOwnProperty.call(a,u)?Array.isArray(o[p])?o[p].push(v):o[p]=[o[p],v]:o[p]=v}return o}function i(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}}function n(r,n,o,e){return n=n||"&",o=o||"=",null===r&&(r=void 0),"object"==typeof r?Object.keys(r).map(function(e){var t=encodeURIComponent(i(e))+o;return Array.isArray(r[e])?r[e].map(function(e){return t+encodeURIComponent(i(e))}).join(n):t+encodeURIComponent(i(r[e]))}).join(n):e?encodeURIComponent(i(e))+o+encodeURIComponent(i(r)):""}function t(e,t){return d(e,!1,!0).resolve(t)}function o(e,t){return e?d(e,!1,!0).resolveObject(t):t}function s(e){return N.isString(e)&&(e=d(e)),e instanceof O?e.format():O.prototype.format.call(e)}var z=e(function(e,t){t.decode=t.parse=r,t.encode=t.stringify=n}),h=d,l=O;function O(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var M=/^([a-z0-9.+-]+:)/i,c=/:[0-9]*$/,R=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,f=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),F=["'"].concat(f),_=["%","/","?",";","#"].concat(F),L=["/","?","#"],D=/^[+a-z0-9A-Z_-]{0,63}$/,H=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Z={javascript:!0,"javascript:":!0},G={javascript:!0,"javascript:":!0},$={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function d(e,t,r){if(e&&N.isObject(e)&&e instanceof O)return e;var n=new O;return n.parse(e,t,r),n}O.prototype.parse=function(e,t,r){if(!N.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var n=e.indexOf("?"),o=-1!==n&&n<e.indexOf("#")?"?":"#",i=e.split(o);i[0]=i[0].replace(/\\/g,"/");var s=e=i.join(o);if(s=s.trim(),!r&&1===e.split("#").length){var a=R.exec(s);if(a)return this.path=s,this.href=s,this.pathname=a[1],a[2]?(this.search=a[2],this.query=t?z.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var u=M.exec(s);if(u){var h=(u=u[0]).toLowerCase();this.protocol=h,s=s.substr(u.length)}if(r||u||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var l="//"===s.substr(0,2);!l||u&&G[u]||(s=s.substr(2),this.slashes=!0)}if(!G[u]&&(l||u&&!$[u])){for(var c,f,p=-1,v=0;v<L.length;v++){-1!==(d=s.indexOf(L[v]))&&(-1===p||d<p)&&(p=d)}-1!==(f=-1===p?s.lastIndexOf("@"):s.lastIndexOf("@",p))&&(c=s.slice(0,f),s=s.slice(f+1),this.auth=decodeURIComponent(c)),p=-1;for(v=0;v<_.length;v++){var d;-1!==(d=s.indexOf(_[v]))&&(-1===p||d<p)&&(p=d)}-1===p&&(p=s.length),this.host=s.slice(0,p),s=s.slice(p),this.parseHost(),this.hostname=this.hostname||"";var y="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!y)for(var m=this.hostname.split(/\./),g=(v=0,m.length);v<g;v++){var b=m[v];if(b&&!b.match(D)){for(var x="",w=0,A=b.length;w<A;w++)127<b.charCodeAt(w)?x+="x":x+=b[w];if(!x.match(D)){var j=m.slice(0,v),C=m.slice(v+1),k=b.match(H);k&&(j.push(k[1]),C.unshift(k[2])),C.length&&(s="/"+C.join(".")+s),this.hostname=j.join(".");break}}}255<this.hostname.length?this.hostname="":this.hostname=this.hostname.toLowerCase(),y||(this.hostname=E.toASCII(this.hostname));var S=this.port?":"+this.port:"",O=this.hostname||"";this.host=O+S,this.href+=this.host,y&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!Z[h])for(v=0,g=F.length;v<g;v++){var P=F[v];if(-1!==s.indexOf(P)){var q=encodeURIComponent(P);q===P&&(q=escape(P)),s=s.split(P).join(q)}}var T=s.indexOf("#");-1!==T&&(this.hash=s.substr(T),s=s.slice(0,T));var I=s.indexOf("?");if(-1!==I?(this.search=s.substr(I),this.query=s.substr(I+1),t&&(this.query=z.parse(this.query)),s=s.slice(0,I)):t&&(this.search="",this.query={}),s&&(this.pathname=s),$[h]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){S=this.pathname||"";var B=this.search||"";this.path=S+B}return this.href=this.format(),this},O.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",o=!1,i="";this.host?o=e+this.host:this.hostname&&(o=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(o+=":"+this.port)),this.query&&N.isObject(this.query)&&Object.keys(this.query).length&&(i=z.stringify(this.query));var s=this.search||i&&"?"+i||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||$[t])&&!1!==o?(o="//"+(o||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):o||(o=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),t+o+(r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(s=s.replace("#","%23"))+n},O.prototype.resolve=function(e){return this.resolveObject(d(e,!1,!0)).format()},O.prototype.resolveObject=function(e){if(N.isString(e)){var t=new O;t.parse(e,!1,!0),e=t}for(var r=new O,n=Object.keys(this),o=0;o<n.length;o++){var i=n[o];r[i]=this[i]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var s=Object.keys(e),a=0;a<s.length;a++){var u=s[a];"protocol"!==u&&(r[u]=e[u])}return $[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!$[e.protocol]){for(var h=Object.keys(e),l=0;l<h.length;l++){var c=h[l];r[c]=e[c]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||G[e.protocol])r.pathname=e.pathname;else{for(var f=(e.pathname||"").split("/");f.length&&!(e.host=f.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),r.pathname=f.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var p=r.pathname||"",v=r.search||"";r.path=p+v}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var d=r.pathname&&"/"===r.pathname.charAt(0),y=e.host||e.pathname&&"/"===e.pathname.charAt(0),m=y||d||r.host&&e.pathname,g=m,b=r.pathname&&r.pathname.split("/")||[],x=(f=e.pathname&&e.pathname.split("/")||[],r.protocol&&!$[r.protocol]);if(x&&(r.hostname="",r.port=null,r.host&&(""===b[0]?b[0]=r.host:b.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===f[0]?f[0]=e.host:f.unshift(e.host)),e.host=null),m=m&&(""===f[0]||""===b[0])),y)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,b=f;else if(f.length)b||(b=[]),b.pop(),b=b.concat(f),r.search=e.search,r.query=e.query;else if(!N.isNullOrUndefined(e.search)){if(x)r.hostname=r.host=b.shift(),(k=!!(r.host&&0<r.host.indexOf("@"))&&r.host.split("@"))&&(r.auth=k.shift(),r.host=r.hostname=k.shift());return r.search=e.search,r.query=e.query,N.isNull(r.pathname)&&N.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!b.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var w=b.slice(-1)[0],A=(r.host||e.host||1<b.length)&&("."===w||".."===w)||""===w,j=0,C=b.length;0<=C;C--)"."===(w=b[C])?b.splice(C,1):".."===w?(b.splice(C,1),j++):j&&(b.splice(C,1),j--);if(!m&&!g)for(;j--;j)b.unshift("..");!m||""===b[0]||b[0]&&"/"===b[0].charAt(0)||b.unshift(""),A&&"/"!==b.join("/").substr(-1)&&b.push("");var k,S=""===b[0]||b[0]&&"/"===b[0].charAt(0);x&&(r.hostname=r.host=S?"":b.length?b.shift():"",(k=!!(r.host&&0<r.host.indexOf("@"))&&r.host.split("@"))&&(r.auth=k.shift(),r.host=r.hostname=k.shift()));return(m=m||r.host&&b.length)&&!S&&b.unshift(""),b.length?r.pathname=b.join("/"):(r.pathname=null,r.path=null),N.isNull(r.pathname)&&N.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},O.prototype.parseHost=function(){var e=this.host,t=c.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};var y={parse:h,resolve:t,resolveObject:o,format:s,Url:l},m=p.defaults.adapter;p.defaults.adapter=a?m:require("axios/lib/adapters/http");var g={readBlockAsync:function(n,o,i){return new Promise(function(e,t){var r=n.slice||n.mozSlice||n.webkitSlice;return r?e(r.call(n,o,i)):t(new Error("not support File type!"))})}};function b(e,t){for(var r=0,n=e.length-1;0<=n;n--){var o=e[n];"."===o?e.splice(n,1):".."===o?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}function x(e){return w.exec(e).slice(1)}var w=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;function A(){for(var e="",t=!1,r=arguments.length-1;-1<=r&&!t;r--){var n=0<=r?arguments[r]:"/";if("string"!=typeof n)throw new TypeError("Arguments to path.resolve must be strings");n&&(e=n+"/"+e,t="/"===n.charAt(0))}return(t?"/":"")+(e=b(S(e.split("/"),function(e){return!!e}),!t).join("/"))||"."}function j(e){var t=C(e),r="/"===P(e,-1);return(e=b(S(e.split("/"),function(e){return!!e}),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e}function C(e){return"/"===e.charAt(0)}var k={extname:function(e){return x(e)[3]},basename:function(e,t){var r=x(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},dirname:function(e){var t=x(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},sep:"/",delimiter:":",relative:function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;0<=r&&""===e[r];r--);return r<t?[]:e.slice(t,r-t+1)}e=A(e).substr(1),t=A(t).substr(1);for(var n=r(e.split("/")),o=r(t.split("/")),i=Math.min(n.length,o.length),s=i,a=0;a<i;a++)if(n[a]!==o[a]){s=a;break}var u=[];for(a=s;a<n.length;a++)u.push("..");return(u=u.concat(o.slice(s))).join("/")},join:function(){return j(S(Array.prototype.slice.call(arguments,0),function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},isAbsolute:C,normalize:j,resolve:A};function S(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}var P="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)};function q(e){return null!=e&&(Y(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&Y(e.slice(0,0))}(e)||!!e._isBuffer)}var T=function(e,t,i,a){function w(e,t){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}function A(e,t){return e<<t|e>>>32-t}function u(e,t){e[t>>5]|=128<<24-t%32,e[15+(t+64>>9<<4)]=t;for(var r,n,o,i,s,a=[80],u=1732584193,h=-271733879,l=-1732584194,c=271733878,f=-1009589776,p=0;p<e.length;p+=16){for(var v=u,d=h,y=l,m=c,g=f,b=0;b<80;b++){a[b]=b<16?e[p+b]:A(a[b-3]^a[b-8]^a[b-14]^a[b-16],1);var x=w(w(A(u,5),(o=h,i=l,s=c,(n=b)<20?o&i|~o&s:n<40?o^i^s:n<60?o&i|o&s|i&s:o^i^s)),w(w(f,a[b]),(r=b)<20?1518500249:r<40?1859775393:r<60?-1894007588:-899497514));f=c,c=l,l=A(h,30),h=u,u=x}u=w(u,v),h=w(h,d),l=w(l,y),c=w(c,m),f=w(f,g)}return[u,h,l,c,f]}function h(e){for(var t=[],r=(1<<a)-1,n=0;n<e.length*a;n+=a)t[n>>5]|=(e.charCodeAt(n/8)&r)<<32-a-n%32;return t}return i||(i="="),a||(a=8),function(e){for(var t="",r=0;r<4*e.length;r+=3)for(var n=(e[r>>2]>>8*(3-r%4)&255)<<16|(e[r+1>>2]>>8*(3-(r+1)%4)&255)<<8|e[r+2>>2]>>8*(3-(r+2)%4)&255,o=0;o<4;o++)8*r+6*o>32*e.length?t+=i:t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n>>6*(3-o)&63);return t}(function(e,t){var r=h(e);16<r.length&&(r=u(r,e.length*a));for(var n=[16],o=[16],i=0;i<16;i++)n[i]=909522486^r[i],o[i]=1549556828^r[i];var s=u(n.concat(h(t)),512+t.length*a);return u(o.concat(s),672)}(e,t))},I=e(function(u,c){!function(e){var t=c,r=u&&u.exports==t&&u,n="object"==typeof U&&U;n.global!==n&&n.window!==n||(e=n);function o(e){this.message=e}(o.prototype=new Error).name="InvalidCharacterError";function h(e){throw new o(e)}var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=/[\t\n\f\r ]/g,i={encode:function(e){e=String(e),/[^\0-\xFF]/.test(e)&&h("The string to be encoded contains characters outside of the Latin1 range.");for(var t,r,n,o,i=e.length%3,s="",a=-1,u=e.length-i;++a<u;)t=e.charCodeAt(a)<<16,r=e.charCodeAt(++a)<<8,n=e.charCodeAt(++a),s+=l.charAt((o=t+r+n)>>18&63)+l.charAt(o>>12&63)+l.charAt(o>>6&63)+l.charAt(63&o);return 2==i?(t=e.charCodeAt(a)<<8,r=e.charCodeAt(++a),s+=l.charAt((o=t+r)>>10)+l.charAt(o>>4&63)+l.charAt(o<<2&63)+"="):1==i&&(o=e.charCodeAt(a),s+=l.charAt(o>>2)+l.charAt(o<<4&63)+"=="),s},decode:function(e){var t=(e=String(e).replace(a,"")).length;t%4==0&&(t=(e=e.replace(/==?$/,"")).length),t%4!=1&&!/[^+a-zA-Z0-9/]/.test(e)||h("Invalid character: the string to be decoded is not correctly encoded.");for(var r,n,o=0,i="",s=-1;++s<t;)n=l.indexOf(e.charAt(s)),r=o%4?64*r+n:n,o++%4&&(i+=String.fromCharCode(255&r>>(-2*o&6)));return i},version:"0.1.0"};if(t&&!t.nodeType)if(r)r.exports=i;else for(var s in i)i.hasOwnProperty(s)&&(t[s]=i[s]);else e.base64=i}(U)}),B="3.4.6",J=e(function(e){var i,r;i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&r.rotl(e,8)|4278255360&r.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=r.endian(e[t]);return e},randomBytes:function(e){for(var t=[];0<e;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],r=0,n=0;r<e.length;r++,n+=8)t[n>>>5]|=e[r]<<24-n%32;return t},wordsToBytes:function(e){for(var t=[],r=0;r<32*e.length;r+=8)t.push(e[r>>>5]>>>24-r%32&255);return t},bytesToHex:function(e){for(var t=[],r=0;r<e.length;r++)t.push((e[r]>>>4).toString(16)),t.push((15&e[r]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(parseInt(e.substr(r,2),16));return t},bytesToBase64:function(e){for(var t=[],r=0;r<e.length;r+=3)for(var n=e[r]<<16|e[r+1]<<8|e[r+2],o=0;o<4;o++)8*r+6*o<=8*e.length?t.push(i.charAt(n>>>6*(3-o)&63)):t.push("=");return t.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var t=[],r=0,n=0;r<e.length;n=++r%4)0!=n&&t.push((i.indexOf(e.charAt(r-1))&Math.pow(2,-2*n+8)-1)<<2*n|i.indexOf(e.charAt(r))>>>6-2*n);return t}},e.exports=r}),K={utf8:{stringToBytes:function(e){return K.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(K.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],r=0;r<e.length;r++)t.push(255&e.charCodeAt(r));return t},bytesToString:function(e){for(var t=[],r=0;r<e.length;r++)t.push(String.fromCharCode(e[r]));return t.join("")}}},W=K;function Y(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}var X=e(function(e){var m,g,b,x,w;m=J,g=W.utf8,b=q,x=W.bin,(w=function(e,t){e.constructor==String?e=t&&"binary"===t.encoding?x.stringToBytes(e):g.stringToBytes(e):b(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());for(var r=m.bytesToWords(e),n=8*e.length,o=1732584193,i=-271733879,s=-1732584194,a=271733878,u=0;u<r.length;u++)r[u]=16711935&(r[u]<<8|r[u]>>>24)|4278255360&(r[u]<<24|r[u]>>>8);r[n>>>5]|=128<<n%32,r[14+(64+n>>>9<<4)]=n;var h=w._ff,l=w._gg,c=w._hh,f=w._ii;for(u=0;u<r.length;u+=16){var p=o,v=i,d=s,y=a;i=f(i=f(i=f(i=f(i=c(i=c(i=c(i=c(i=l(i=l(i=l(i=l(i=h(i=h(i=h(i=h(i,s=h(s,a=h(a,o=h(o,i,s,a,r[u+0],7,-680876936),i,s,r[u+1],12,-389564586),o,i,r[u+2],17,606105819),a,o,r[u+3],22,-1044525330),s=h(s,a=h(a,o=h(o,i,s,a,r[u+4],7,-176418897),i,s,r[u+5],12,1200080426),o,i,r[u+6],17,-1473231341),a,o,r[u+7],22,-45705983),s=h(s,a=h(a,o=h(o,i,s,a,r[u+8],7,1770035416),i,s,r[u+9],12,-1958414417),o,i,r[u+10],17,-42063),a,o,r[u+11],22,-1990404162),s=h(s,a=h(a,o=h(o,i,s,a,r[u+12],7,1804603682),i,s,r[u+13],12,-40341101),o,i,r[u+14],17,-1502002290),a,o,r[u+15],22,1236535329),s=l(s,a=l(a,o=l(o,i,s,a,r[u+1],5,-165796510),i,s,r[u+6],9,-1069501632),o,i,r[u+11],14,643717713),a,o,r[u+0],20,-373897302),s=l(s,a=l(a,o=l(o,i,s,a,r[u+5],5,-701558691),i,s,r[u+10],9,38016083),o,i,r[u+15],14,-660478335),a,o,r[u+4],20,-405537848),s=l(s,a=l(a,o=l(o,i,s,a,r[u+9],5,568446438),i,s,r[u+14],9,-1019803690),o,i,r[u+3],14,-187363961),a,o,r[u+8],20,1163531501),s=l(s,a=l(a,o=l(o,i,s,a,r[u+13],5,-1444681467),i,s,r[u+2],9,-51403784),o,i,r[u+7],14,1735328473),a,o,r[u+12],20,-1926607734),s=c(s,a=c(a,o=c(o,i,s,a,r[u+5],4,-378558),i,s,r[u+8],11,-2022574463),o,i,r[u+11],16,1839030562),a,o,r[u+14],23,-35309556),s=c(s,a=c(a,o=c(o,i,s,a,r[u+1],4,-1530992060),i,s,r[u+4],11,1272893353),o,i,r[u+7],16,-155497632),a,o,r[u+10],23,-1094730640),s=c(s,a=c(a,o=c(o,i,s,a,r[u+13],4,681279174),i,s,r[u+0],11,-358537222),o,i,r[u+3],16,-722521979),a,o,r[u+6],23,76029189),s=c(s,a=c(a,o=c(o,i,s,a,r[u+9],4,-640364487),i,s,r[u+12],11,-421815835),o,i,r[u+15],16,530742520),a,o,r[u+2],23,-995338651),s=f(s,a=f(a,o=f(o,i,s,a,r[u+0],6,-198630844),i,s,r[u+7],10,1126891415),o,i,r[u+14],15,-1416354905),a,o,r[u+5],21,-57434055),s=f(s,a=f(a,o=f(o,i,s,a,r[u+12],6,1700485571),i,s,r[u+3],10,-1894986606),o,i,r[u+10],15,-1051523),a,o,r[u+1],21,-2054922799),s=f(s,a=f(a,o=f(o,i,s,a,r[u+8],6,1873313359),i,s,r[u+15],10,-30611744),o,i,r[u+6],15,-1560198380),a,o,r[u+13],21,1309151649),s=f(s,a=f(a,o=f(o,i,s,a,r[u+4],6,-145523070),i,s,r[u+11],10,-1120210379),o,i,r[u+2],15,718787259),a,o,r[u+9],21,-343485551),o=o+p>>>0,i=i+v>>>0,s=s+d>>>0,a=a+y>>>0}return m.endian([o,i,s,a])})._ff=function(e,t,r,n,o,i,s){var a=e+(t&r|~t&n)+(o>>>0)+s;return(a<<i|a>>>32-i)+t},w._gg=function(e,t,r,n,o,i,s){var a=e+(t&n|r&~n)+(o>>>0)+s;return(a<<i|a>>>32-i)+t},w._hh=function(e,t,r,n,o,i,s){var a=e+(t^r^n)+(o>>>0)+s;return(a<<i|a>>>32-i)+t},w._ii=function(e,t,r,n,o,i,s){var a=e+(r^(t|~n))+(o>>>0)+s;return(a<<i|a>>>32-i)+t},w._blocksize=16,w._digestsize=16,e.exports=function(e,t){if(null==e)throw new Error("Illegal argument "+e);var r=m.wordsToBytes(w(e,t));return t&&t.asBytes?r:t&&t.asString?x.bytesToString(r):m.bytesToHex(r)}});function Q(e,t){var r=[t.method,t.path];["date","policy","contentMd5"].forEach(function(e){t[e]&&r.push(t[e])});var n=T(e.password,r.join("&"));return"UPYUN "+e.operatorName+":"+n}function V(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var ee={genSign:Q,getHeaderSign:function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null,o=(new Date).toGMTString();return{Authorization:Q(e,{method:t,path:r="/"+e.serviceName+r,date:o,contentMd5:n}),"X-Date":o}},getPolicyAndAuthorization:function(e,t){if(t.service=e.serviceName,void 0===t["save-key"])throw new Error("upyun - calclate body sign need save-key");void 0===t.expiration&&(t.expiration=parseInt(new Date/1e3+1800,10));var r=I.encode(JSON.stringify(t));return{policy:r,authorization:Q(e,{method:"POST",path:"/"+e.serviceName,policy:r,contentMd5:t["content-md5"]})}},getPurgeHeaderSign:function(e,t){var r=(new Date).toGMTString(),n=t.join("\n"),o=X(n+"&"+e.serviceName+"&"+r+"&"+e.password);return{Authorization:"UpYun "+e.serviceName+":"+e.operatorName+":"+o,Date:r,"User-Agent":"Js-Sdk/"+B}}};function te(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var re=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{!n&&a.return&&a.return()}finally{if(o)throw i}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function ne(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(V(this,ne),void 0===e.serviceName)throw new Error("upyun - must config serviceName");if("function"==typeof t&&(r=t,t={}),"function"!=typeof r&&a)throw new Error("upyun - must config a callback function getHeaderSign in client side");if(!a&&(void 0===e.operatorName||void 0===e.password))throw new Error("upyun - must config operateName and password in server side");var n=Object.assign({domain:"v0.api.upyun.com",protocol:"https"},t);this.endpoint=n.protocol+"://"+n.domain;var o=n.proxy;this.proxy=o,this.req=function(e,o,i){var t=(3<arguments.length&&void 0!==arguments[3]?arguments[3]:{}).proxy,r=p.create({baseURL:e+"/"+o.serviceName,maxRedirects:0,proxy:t});return r.interceptors.request.use(function(t){var e=t.method.toUpperCase(),r=y.resolve("/",encodeURI(t.url||""));0===r.indexOf(t.baseURL)&&(r=r.substring(t.baseURL.length)),t.url=r;var n=i(o,e,r,t.headers["Content-MD5"]);return(n=v(n)?n:Promise.resolve(n)).then(function(e){return t.headers.common=e,Promise.resolve(t)})},function(e){throw new Error("upyun - request failed: "+e.message)}),r.interceptors.response.use(function(e){return e},function(e){var t=e.response;if(void 0===t)throw e;if(404===t.status)return t;var r=new Error("upyun - response error: "+e.message);throw e.response.data&&e.response.data.code&&(r.code=e.response.data.code),r}),r}(this.endpoint,e,r||ie,{proxy:o}),this.bucket=e,this.service=e,a||this.setBodySignCallback(ee.getPolicyAndAuthorization)}function oe(e){return 0===e.indexOf("x-upyun-meta-")}function ie(){return ee.getHeaderSign.apply(ee,arguments)}function se(e){var t={},r=!0,n=!1,o=void 0;try{for(var i,s=Object.keys(e)[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var a=i.value;t[a.toLowerCase()]=e[a]}}catch(e){n=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw o}}return t}function ae(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"";V(this,ae),this.bucketName=e,this.serviceName=this.bucketName,this.operatorName=t,this.password=X(r)}return{Client:(function(e,t,r){return t&&te(e.prototype,t),r&&te(e,r),e}(ne,[{key:"setService",value:function(e){this.service=e,this.req.defaults.baseURL=this.endpoint+"/"+e.serviceName}},{key:"setBucket",value:function(e){return this.setService(e)}},{key:"setBodySignCallback",value:function(e){if("function"!=typeof e)throw new Error("upyun - getBodySign should be a function");this.bodySignCallback=e}},{key:"usage",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"/";return this.req.get(e+"?usage").then(function(e){var t=e.data;return Promise.resolve(t)})}},{key:"listDir",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"/",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=t.limit,n=void 0===r?100:r,o=t.order,i=void 0===o?"asc":o,s=t.iter,a=void 0===s?"":s,u={};return 100!==n&&(u["x-list-limit"]=n),"asc"!==i&&(u["x-list-order"]=i),a&&(u["x-list-iter"]=a),this.req.get(e,{headers:u}).then(function(e){var t=e.data,r=e.headers;if(404===e.status)return!1;var n=r["x-upyun-list-iter"];if(!t)return Promise.resolve({files:[],next:n});var o=t.split("\n").map(function(e){var t=e.split("\t"),r=re(t,4),n=r[0],o=r[1],i=r[2],s=r[3];return{name:n,type:o,size:parseInt(i),time:parseInt(s)}});return Promise.resolve({files:o,next:n})})}},{key:"putFile",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=["Content-MD5","Content-Length","Content-Type","Content-Secret","x-gmkerl-thumb"],o={},i={},s=!0,a=!1,u=void 0;try{for(var h,l=Object.keys(r)[Symbol.iterator]();!(s=(h=l.next()).done);s=!0){var c=h.value;i[c.toLowerCase()]=r[c]}}catch(e){a=!0,u=e}finally{try{!s&&l.return&&l.return()}finally{if(a)throw u}}var f=!0,p=!1,v=void 0;try{for(var d,y=Object.keys(i)[Symbol.iterator]();!(f=(d=y.next()).done);f=!0){var m=d.value;oe(m)&&i[m]?o[m]=i[m]:n.forEach(function(e){var t=e.toLowerCase(),r=i[t];r&&(o[e]=r)})}}catch(e){p=!0,v=e}finally{try{!f&&y.return&&y.return()}finally{if(p)throw v}}return this.req.put(e,t,{headers:o}).then(function(e){var r=e.headers;if(200!==e.status)return Promise.resolve(!1);var n={};return["x-upyun-width","x-upyun-height","x-upyun-file-type","x-upyun-frames"].forEach(function(e){var t=e.split("x-upyun-")[1];r[e]&&(n[t]=r[e],"file-type"!==t&&(n[t]=parseInt(n[t],10)))}),Promise.resolve(!(0<Object.keys(n).length)||n)})}},{key:"initMultipartUpload",value:function(e,t){var r=this,n=void 0,o=se(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}),i=o["x-upyun-multi-type"];return i=a?(n=Promise.resolve(t.size),i||t.type):Buffer.isBuffer(t)?(n=Promise.resolve(t.length),i||"application/octet-stream"):(n=g.getFileSizeAsync(t),i||g.getContentType(t)),n.then(function(n){return Object.assign(o,{"x-upyun-multi-disorder":!0,"x-upyun-multi-stage":"initiate","x-upyun-multi-length":n,"x-upyun-multi-type":i}),r.req.put(e,null,{headers:o}).then(function(e){var t=e.headers;if(204!==e.status)return Promise.resolve(!1);var r=t["x-upyun-multi-uuid"];return Promise.resolve({fileSize:n,partCount:Math.ceil(n/u),uuid:r})})})}},{key:"multipartUpload",value:function(t,r,n,o){var i=this,s=o*u;return(a?Promise.resolve(r.size):Buffer.isBuffer(r)?Promise.resolve(r.length):g.getFileSizeAsync(r)).then(function(e){var t=Math.min(s+u,e);return Buffer.isBuffer(r)?r.slice(s,t):g.readBlockAsync(r,s,t)}).then(function(e){return i.req.put(t,e,{headers:{"x-upyun-multi-stage":"upload","x-upyun-multi-uuid":n,"x-upyun-part-id":o}}).then(function(e){var t=e.status;return Promise.resolve(204===t)})})}},{key:"completeMultipartUpload",value:function(e,t){return this.req.put(e,null,{headers:{"x-upyun-multi-stage":"complete","x-upyun-multi-uuid":t}}).then(function(e){var t=e.status;return Promise.resolve(204===t||201===t)})}},{key:"makeDir",value:function(e){return this.req.post(e,null,{headers:{folder:"true"}}).then(function(e){var t=e.status;return Promise.resolve(200===t)})}},{key:"copy",value:function(e,t){var r=se(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}),n=Object.assign(r,{"x-upyun-copy-source":k.join("/",this.service.serviceName,t)});return this.req.put(e,null,{headers:n}).then(function(e){var t=e.status;return Promise.resolve(200<=t&&t<300)})}},{key:"move",value:function(e,t){var r=se(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}),n=Object.assign(r,{"x-upyun-move-source":k.join("/",this.service.serviceName,t)});return this.req.put(e,null,{headers:n}).then(function(e){var t=e.status;return Promise.resolve(200<=t&&t<300)})}},{key:"headFile",value:function(e){return this.req.head(e).then(function(e){var r=e.headers;if(404===e.status)return Promise.resolve(!1);var n={"Content-Md5":r["content-md5"]||""};return["x-upyun-file-type","x-upyun-file-size","x-upyun-file-date"].forEach(function(e){var t=e.split("x-upyun-file-")[1];r[e]&&(n[t]=r[e],"size"!==t&&"date"!==t||(n[t]=parseInt(n[t],10)))}),Promise.resolve(n)})}},{key:"deleteFile",value:function(e){var t={};return 1<arguments.length&&void 0!==arguments[1]&&arguments[1]&&(t["x-upyun-async"]=!0),this.req.delete(e,{headers:t}).then(function(e){var t=e.status;return Promise.resolve(200===t)})}},{key:"deleteDir",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.deleteFile.apply(this,t)}},{key:"getFile",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;if(t&&a)throw new Error("upyun - save as stream are only available on the server side.");return this.req({method:"GET",url:e,responseType:t?"stream":null}).then(function(e){if(404===e.status)return Promise.resolve(!1);if(!t)return Promise.resolve(e.data);var r=e.data.pipe(t);return new Promise(function(e,t){r.on("finish",function(){return e(r)}),r.on("error",t)})})}},{key:"updateMetadata",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"merge",n={};for(var o in t)oe(o)?n[o]=t:n["x-upyun-meta-"+o]=t[o];return this.req.patch(e+"?metadata="+r,null,{headers:n}).then(function(e){var t=e.status;return Promise.resolve(200===t)})}},{key:"getMetadata",value:function(e){return this.req.get(e).then(function(e){var t=e.headers;if(200!==e.status)return Promise.resolve(!1);var r={};for(var n in t)oe(n)&&(r[n]=t[n]);return Promise.resolve(r)})}},{key:"blockUpload",value:function(h,l){var c=this,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},t=void 0,r=void 0;return r=a?(t=Promise.resolve(l.size),l.type):(t=g.getFileSizeAsync(l),g.getContentType(l)),t.then(function(s){Object.assign(e,{"x-upyun-multi-stage":"initiate","x-upyun-multi-length":s,"x-upyun-multi-type":r});var a=1048576,u=Math.ceil(s/a);return c.req.put(h,null,{headers:e}).then(function(e){for(var t=e.headers,n=t["x-upyun-multi-uuid"],r=t["x-upyun-next-part-id"],o=Promise.resolve(r),i=0;i<u;i++)o=o.then(function(r){var e=r*a,t=Math.min(e+a,s);return g.readBlockAsync(l,e,t).then(function(e){return c.req.put(h,e,{headers:{"x-upyun-multi-stage":"upload","x-upyun-multi-uuid":n,"x-upyun-part-id":r}}).then(function(e){var t=e.headers;return r=t["x-upyun-next-part-id"],Promise.resolve(r)})})});return o.then(function(){return c.req.put(h,null,{headers:{"x-upyun-multi-stage":"complete","x-upyun-multi-uuid":n}}).then(function(e){var t=e.status;return Promise.resolve(204===t||201===t)})})})})}},{key:"formPutFile",value:function(e,t){var r=this,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},i={},s=!0,a=!1,u=void 0;try{for(var h,l=Object.keys(n)[Symbol.iterator]();!(s=(h=l.next()).done);s=!0){var c=h.value;i[c.toLowerCase()]=n[c]}}catch(e){a=!0,u=e}finally{try{!s&&l.return&&l.return()}finally{if(a)throw u}}if("function"!=typeof this.bodySignCallback)throw new Error("upyun - must setBodySignCallback first!");i.service=this.service.serviceName,i["save-key"]=e;var f=this.bodySignCallback(this.service,i);return(f=v(f)?f:Promise.resolve(f)).then(function(e){return function(e,t,r){var n=r.authorization,o=r.policy,i=(3<arguments.length&&void 0!==arguments[3]?arguments[3]:{}).filename,s=new FormData;return s.append("authorization",n),s.append("policy",o),"string"==typeof t&&(t=new Blob([t],{type:"text/plain"})),i=i?k.basename(i):i,s.append("file",t,i),p.post(e,s).then(function(e){var t=e.status,r=e.data;return 200===t&&Promise.resolve(r)})}(r.endpoint+"/"+i.service,t,e,o)})}},{key:"purge",value:function(e){"string"==typeof e&&(e=[e]);var t=ee.getPurgeHeaderSign(this.service,e);return p.post("http://purge.upyun.com/purge/","purge="+e.join("\n"),{headers:t,proxy:this.proxy}).then(function(e){var t=e.data;if(0===Object.keys(t.invalid_domain_of_url).length)return!0;throw new Error("some url purge failed "+t.invalid_domain_of_url.join(" "))},function(e){throw new Error("upyun - request failed: "+e.message)})}}]),ne),sign:ee,Bucket:ae,Service:ae}});